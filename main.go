package main

import (
	"fyne.io/fyne/v2"
	"fyne.io/fyne/v2/app"
	"fyne.io/fyne/v2/container"
	"fyne.io/fyne/v2/widget"
)

var (
	reconCompleted   bool
	analyzeCompleted bool
)

func reconnaissance() {

	reconCompleted = true
}

func analyseVulnerabilites() {

	analyzeCompleted = true
}

func main() {
	a := app.New()
	w := a.NewWindow("Pentest Recap")
	w.Resize(fyne.NewSize(800, 800))

	progressBar := widget.NewProgressBar()

	reconButton := widget.NewButton("Commencer Reconnaissance", func() {
		reconnaissance()
		updateProgressBar(progressBar)
	})
	analyzeButton := widget.NewButton("Commencer Analyse des vulnérabilités", func() {
		analyseVulnerabilites()
		updateProgressBar(progressBar)
	})
	// Add buttons for the remaining steps

	// Create content for the pages of each step
	reconContent := container.NewVBox(
		widget.NewLabel("Page de la Reconnaissance"),
	)
	analyzeContent := container.NewVBox(
		widget.NewLabel("Page de l'Analyse des vulnérabilités"),
	)

	tabs := container.NewAppTabs(
		container.NewTabItem("Accueil", widget.NewLabel("Bienvenue dans l'outil de récapitulation des étapes de pentest !")),
		container.NewTabItem("Reconnaissance", container.NewVScroll(reconContent)),
		container.NewTabItem("Analyse des vulnérabilités", container.NewVScroll(analyzeContent)),
	)

	progressLayout := container.NewVBox(
		progressBar,
		container.NewHBox(reconButton, analyzeButton),
	)

	mainLayout := container.NewHBox(progressLayout, tabs)

	w.SetContent(mainLayout)
	w.ShowAndRun()
}

func updateProgressBar(progressBar *widget.ProgressBar) {
	completedSteps := 0
	totalSteps := 0

	if reconCompleted {
		completedSteps++
	}
	if analyzeCompleted {
		completedSteps++
	}

	totalSteps = 2

	progress := float64(completedSteps) / float64(totalSteps)
	progressBar.SetValue(progress)
}
